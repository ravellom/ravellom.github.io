<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Ejercicios Educativos</title>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link rel="stylesheet" href="../../assets/css/recuedu.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- RecuEdu Labs Navbar -->
    <nav class="navbar" style="background: #1a1a1a; padding: 8px 0; border-bottom: 1px solid #333;">
        <div class="container nav-content" style="max-width: 100%; padding: 0 20px;">
            <a href="../../index.html" class="logo" style="color: white; text-decoration: none; font-size: 0.9rem;">
                <i class="fa-solid fa-flask-vial" style="margin-right: 8px;"></i> RecuEdu Labs
            </a>
        </div>
    </nav>

    <header class="app-header">
        <div class="brand">
            <i class="ph ph-cube-transparent" style="font-size: 1.5rem;"></i>
            <div>
                <h1>Generador de Ejercicios <span class="badge">v1.0</span></h1>
            </div>
        </div>
        <div class="actions">
            <button id="btn-undo" class="btn btn-secondary" disabled title="Deshacer">
                <i class="ph ph-arrow-counter-clockwise"></i> Deshacer
            </button>
            <button id="btn-redo" class="btn btn-secondary" disabled title="Rehacer">
                <i class="ph ph-arrow-clockwise"></i> Rehacer
            </button>
            <button id="btn-save-project" class="btn btn-secondary" aria-label="Guardar proyecto">
                <i class="ph ph-floppy-disk"></i> Guardar Proyecto
            </button>
            <button id="btn-export" class="btn btn-primary" disabled aria-label="Exportar JSON">
                <i class="ph ph-download-simple"></i> Exportar JSON
            </button>
            <button id="btn-export-html" class="btn btn-primary" disabled aria-label="Exportar HTML">
                <i class="ph ph-file-html"></i> Exportar HTML
            </button>
        </div>
    </header>

    <main class="workspace">
        <aside class="sidebar">
            <div class="panel">
                <h3><i class="ph ph-magic-wand"></i> Asistente IA</h3>
                <button id="btn-show-prompt" class="btn btn-prompt-action" aria-label="Obtener prompt maestro">
                    <i class="ph ph-chat-circle-text"></i> Obtener Prompt Maestro
                </button>

                <div class="divider"></div>

                <h3><i class="ph ph-magnifying-glass"></i> Buscar y Filtrar</h3>
                <input type="text" id="search-input" class="input-field" placeholder="Buscar por enunciado...">
                <select id="filter-type" class="input-field">
                    <option value="">Todos los tipos</option>
                    <option value="multiple_choice">Elección múltiple</option>
                    <option value="true_false">Verdadero/Falso</option>
                    <option value="fill_gaps">Rellenar huecos</option>
                    <option value="ordering">Ordenar</option>
                    <option value="matching">Relacionar</option>
                    <option value="grouping">Clasificar</option>
                </select>
                <select id="project-select" class="input-field" aria-label="Seleccionar proyecto guardado">
                    <option value="">Seleccionar proyecto...</option>
                </select>
                <button id="btn-load-project" class="btn btn-outline" style="width:100%; margin-top:10px;" aria-label="Cargar proyecto seleccionado">
                    <i class="ph ph-arrow-counter-clockwise"></i> Cargar Proyecto
                </button>
                
                <input type="file" id="file-upload" accept=".json" style="display: none;">
                <button id="btn-upload-trigger" class="btn btn-outline" style="width:100%; margin-bottom:10px; border-style:dashed;" aria-label="Subir archivo JSON">
                    <i class="ph ph-upload-simple"></i> Subir Archivo .JSON
                </button>

                <p class="helper-text">O pega el código aquí:</p>
                <textarea id="json-input" placeholder='Pegar código JSON aquí...'></textarea>
                
                <div class="button-group">
                    <button id="btn-load" class="btn btn-secondary" aria-label="Procesar texto">
                        <i class="ph ph-arrow-counter-clockwise"></i> Procesar Texto
                    </button>
                    <button id="btn-merge" class="btn btn-outline" title="Añadir ejercicios sin borrar los actuales" aria-label="Fusionar ejercicios">
                        <i class="ph ph-plus-circle"></i> Fusionar
                    </button>
                    <button id="btn-clear-json" class="btn btn-outline" title="Limpiar la caja de texto" aria-label="Limpiar JSON">
                        <i class="ph ph-eraser"></i> Limpiar
                    </button>
                </div>
                <div id="status-msg" class="status-msg" aria-live="polite"></div>
            </div>

            <div class="panel metadata-panel hidden" id="meta-panel">
                <h3>Resumen del Recurso</h3>
                <div class="meta-item">
                    <label for="meta-title">Título:</label>
                    <input type="text" id="meta-title" class="input-field" placeholder="Ej. El Ciclo del Agua">
                </div>
                <div class="meta-item">
                    <label for="meta-topic">Tema:</label>
                    <input type="text" id="meta-topic" class="input-field">
                </div>
                <div class="stat-box">
                    <span>Total Ejercicios:</span> <strong id="count-total" style="font-size:1.2rem;">0</strong>
                </div>
            </div>
        </aside>

        <section class="canvas">
            <div id="welcome-screen" class="empty-state">
                <div class="empty-icon-bg">
                    <i class="ph ph-robot"></i>
                </div>
                <h2>Constructor de Ejercicios</h2>
                <p>Sube un archivo .JSON existente o usa "Obtener Prompt" para crear uno nuevo con IA.</p>
            </div>

            <div id="exercise-list" class="exercise-grid hidden">
                </div>
        </section>
    </main>

    <div id="preview-modal" class="modal-overlay hidden" style="display: none;" role="dialog" aria-labelledby="preview-title" aria-describedby="preview-body">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="preview-title">Vista Previa del Ejercicio</h3>
                <button id="btn-close-preview" class="close-icon" aria-label="Cerrar vista previa"><i class="ph ph-x"></i></button>
            </div>
            <div class="modal-body" id="preview-body">
                <div id="preview-content"></div>
            </div>
        </div>
    </div>

    <div id="prompt-modal" class="modal-overlay hidden" style="display: none;" role="dialog" aria-labelledby="modal-title" aria-describedby="modal-body">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Prompt para Generar Ejercicios con IA</h3>
                <button id="btn-close-modal" class="close-icon" aria-label="Cerrar modal"><i class="ph ph-x"></i></button>
            </div>
            <div class="modal-body" id="modal-body">
                <p>Copia este texto manualmente (Ctrl + C) y pégalo en tu IA:</p>
                <div class="code-block-wrapper">
                    <textarea id="prompt-text" readonly></textarea>
                    <button id="btn-copy-prompt" class="btn-copy" aria-label="Seleccionar todo el texto"><i class="ph ph-text-aa"></i> Seleccionar Todo</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>